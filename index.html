<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CrossRealm Dev Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --success: #48bb78;
            --danger: #f56565;
            --warning: #ed8936;
            --dark: #1a202c;
            --card: #2d3748;
            --border: #4a5568;
            --text: #e2e8f0;
        }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, var(--dark) 0%, #2d3748 100%);
            color: var(--text);
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1600px; margin: 0 auto; }
        
        /* Header */
        .header {
            background: var(--card);
            border: 2px solid var(--primary);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .header h1 {
            font-size: 32px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        .header-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }
        .dev-wallet-info {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .dev-address {
            font-family: 'Courier New', monospace;
            color: var(--primary);
            font-weight: bold;
            font-size: 14px;
        }
        .dev-balance {
            font-size: 24px;
            font-weight: bold;
            color: var(--success);
        }
        
        /* Platform Status Badge */
        .platform-status {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            background: rgba(72, 187, 120, 0.1);
            border: 2px solid var(--success);
            border-radius: 8px;
            font-weight: bold;
        }
        .platform-status.paused {
            background: rgba(245, 101, 101, 0.1);
            border-color: var(--danger);
        }
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--success);
            animation: pulse 2s infinite;
        }
        .status-indicator.paused {
            background: var(--danger);
            animation: none;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }
        
        /* Balance Cards Grid */
        .balance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .balance-card {
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 25px;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .balance-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        .balance-card.hub { border-color: var(--primary); }
        .balance-card.rewards { border-color: var(--warning); }
        .balance-card.staking { border-color: var(--success); }
        .balance-card.dev { border-color: var(--secondary); }
        
        .balance-card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }
        .balance-icon {
            font-size: 32px;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            background: rgba(102, 126, 234, 0.1);
        }
        .balance-card-title {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #a0aec0;
        }
        .balance-amount {
            font-size: 36px;
            font-weight: bold;
            color: var(--text);
            margin: 10px 0;
        }
        .balance-label {
            font-size: 12px;
            color: #a0aec0;
            margin-top: 5px;
        }
        .balance-details {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border);
            font-size: 13px;
            line-height: 1.8;
        }
        .balance-details div {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        .tab-btn {
            padding: 12px 24px;
            background: var(--card);
            border: 2px solid var(--border);
            color: var(--text);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            font-size: 14px;
        }
        .tab-btn:hover {
            border-color: var(--primary);
            background: rgba(102, 126, 234, 0.1);
        }
        .tab-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-color: var(--primary);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        
        /* Cards */
        .card {
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .card h3 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 18px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Chart Container */
        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
        .chart-container.small {
            height: 250px;
        }
        
        /* Grid */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
        }
        .grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        @media (max-width: 900px) {
            .grid, .grid-3 { grid-template-columns: 1fr; }
        }
        
        /* Forms */
        input, select {
            width: 100%;
            padding: 12px;
            background: rgba(0,0,0,0.3);
            border: 2px solid var(--border);
            color: var(--text);
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 14px;
        }
        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }
        label {
            display: block;
            margin-bottom: 8px;
            color: #a0aec0;
            font-size: 13px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Buttons */
        button {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        button:disabled {
            background: var(--border);
            cursor: not-allowed;
            opacity: 0.5;
        }
        button.success {
            background: linear-gradient(135deg, var(--success), #38a169);
        }
        button.danger {
            background: linear-gradient(135deg, var(--danger), #c53030);
        }
        button.warning {
            background: linear-gradient(135deg, var(--warning), #dd6b20);
        }
        
        /* Stats Table */
        .stats-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .stats-table th,
        .stats-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        .stats-table th {
            color: #a0aec0;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .stats-table td {
            color: var(--text);
            font-size: 14px;
        }
        
        /* Phase Control Panel */
        .phase-control {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .phase-card {
            background: rgba(0,0,0,0.3);
            padding: 20px;
            border-radius: 8px;
            border: 2px solid var(--border);
            text-align: center;
            transition: all 0.3s;
        }
        .phase-card.active {
            border-color: var(--success);
            background: rgba(72, 187, 120, 0.1);
        }
        .phase-card.inactive {
            opacity: 0.6;
        }
        .phase-number {
            font-size: 48px;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        .phase-name {
            font-size: 14px;
            font-weight: bold;
            color: var(--text);
            margin-bottom: 8px;
        }
        .phase-status {
            font-size: 12px;
            padding: 4px 12px;
            border-radius: 12px;
            display: inline-block;
            margin-top: 10px;
        }
        .phase-status.active {
            background: var(--success);
            color: white;
        }
        .phase-status.pending {
            background: var(--warning);
            color: white;
        }
        
        /* Alerts */
        .alert {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            z-index: 9999;
            max-width: 400px;
            font-size: 14px;
            animation: slideIn 0.3s;
            box-shadow: 0 5px 20px rgba(0,0,0,0.4);
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .alert.success { background: var(--success); color: white; }
        .alert.error { background: var(--danger); color: white; }
        .alert.info { background: var(--primary); color: white; }
        
        /* Loading */
        .loading { opacity: 0.6; pointer-events: none; }
        .spinner {
            border: 3px solid var(--border);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* Treasury Overview */
        .treasury-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .treasury-item {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }
        .treasury-item-label {
            font-size: 11px;
            color: #a0aec0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }
        .treasury-item-value {
            font-size: 20px;
            font-weight: bold;
            color: var(--success);
        }
        
        /* Action Buttons */
        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        /* Refresh Badge */
        .refresh-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(72, 187, 120, 0.1);
            border: 1px solid var(--success);
            border-radius: 20px;
            font-size: 12px;
            color: var(--success);
            font-weight: 600;
        }
        .pulse {
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        /* Utilities */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .mt-2 { margin-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üîß CrossRealm Dev Dashboard</h1>
            <div class="header-info">
                <div class="dev-wallet-info">
                    <div class="dev-address" id="devAddress">Dev Wallet: Not Connected</div>
                    <div class="dev-balance" id="devBalance">0.0000 CORE</div>
                </div>
                <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                    <div class="platform-status" id="platformStatus">
                        <div class="status-indicator"></div>
                        <span>Platform: Active</span>
                    </div>
                    <div class="refresh-badge">
                        <div class="pulse"></div>
                        <span>Auto-refresh: 15s</span>
                    </div>
                    <button id="connectBtn" onclick="connectWallet()">Connect Dev Wallet</button>
                    <button onclick="refreshAll()" class="success">üîÑ Refresh All</button>
                </div>
            </div>
        </div>

        <!-- Balance Cards -->
        <div class="balance-grid">
            <!-- Hub Balance -->
            <div class="balance-card hub">
                <div class="balance-card-header">
                    <div class="balance-icon">üè¶</div>
                    <div>
                        <div class="balance-card-title">Hub Contract</div>
                        <div style="font-size: 11px; color: #718096;">Game Stakes Escrow</div>
                    </div>
                </div>
                <div class="balance-amount" id="hubBalance">0.0000</div>
                <div class="balance-label">CORE</div>
                <div class="balance-details">
                    <div>
                        <span>Active Games:</span>
                        <strong id="activeGamesCount">0</strong>
                    </div>
                    <div>
                        <span>Total Volume:</span>
                        <strong id="totalVolumeHub">0 CORE</strong>
                    </div>
                    <div>
                        <span>Address:</span>
                        <span style="font-size: 10px; font-family: monospace;">0x2D0F...9702</span>
                    </div>
                </div>
            </div>

            <!-- Rewards Balance -->
            <div class="balance-card rewards">
                <div class="balance-card-header">
                    <div class="balance-icon">üí∞</div>
                    <div>
                        <div class="balance-card-title">Rewards Contract</div>
                        <div style="font-size: 11px; color: #718096;">Fee Distribution Pool</div>
                    </div>
                </div>
                <div class="balance-amount" id="rewardsBalance">0.0000</div>
                <div class="balance-label">CORE</div>
                <div class="balance-details">
                    <div>
                        <span>Dev Allocation:</span>
                        <strong id="devAllocation">0 CORE</strong>
                    </div>
                    <div>
                        <span>Player Cashback:</span>
                        <strong id="playerCashbackPool">0 CORE</strong>
                    </div>
                    <div>
                        <span>Referrals:</span>
                        <strong id="referralPool">0 CORE</strong>
                    </div>
                </div>
            </div>

            <!-- Staking Balance -->
            <div class="balance-card staking">
                <div class="balance-card-header">
                    <div class="balance-icon">üíé</div>
                    <div>
                        <div class="balance-card-title">Staking Contract</div>
                        <div style="font-size: 11px; color: #718096;">Staking Rewards Pool</div>
                    </div>
                </div>
                <div class="balance-amount" id="stakingBalance">0.0000</div>
                <div class="balance-label">CORE</div>
                <div class="balance-details">
                    <div>
                        <span>Total Staked:</span>
                        <strong id="totalStakedAmount">0 CORE</strong>
                    </div>
                    <div>
                        <span>Your Stake:</span>
                        <strong id="devStakedAmount">0 CORE</strong>
                    </div>
                    <div>
                        <span>Reward Pool:</span>
                        <strong id="stakingRewardPool">0 CORE</strong>
                    </div>
                </div>
            </div>

            <!-- Dev Claimable -->
            <div class="balance-card dev">
                <div class="balance-card-header">
                    <div class="balance-icon">üéÅ</div>
                    <div>
                        <div class="balance-card-title">Dev Claimable</div>
                        <div style="font-size: 11px; color: #718096;">Your Earnings</div>
                    </div>
                </div>
                <div class="balance-amount" id="devClaimable">0.0000</div>
                <div class="balance-label">CORE</div>
                <div class="balance-details">
                    <div>
                        <span>Platform Revenue (54%):</span>
                        <strong id="platformRevenue">0 CORE</strong>
                    </div>
                    <div>
                        <span>Your Cashback (7%):</span>
                        <strong id="devCashback">0 CORE</strong>
                    </div>
                    <div>
                        <span>Staking Rewards:</span>
                        <strong id="devStakingRewards">0 CORE</strong>
                    </div>
                </div>
                <button onclick="claimDevRevenue()" class="success" style="width: 100%; margin-top: 15px;">
                    üíµ Claim Dev Revenue
                </button>
            </div>
        </div>

        <!-- Treasury Overview -->
        <div class="card">
            <h3>üìä Treasury Overview</h3>
            <div class="treasury-overview">
                <div class="treasury-item">
                    <div class="treasury-item-label">Total Locked</div>
                    <div class="treasury-item-value" id="totalLocked">0.0000 CORE</div>
                </div>
                <div class="treasury-item">
                    <div class="treasury-item-label">Total Games</div>
                    <div class="treasury-item-value" id="totalGamesCount">0</div>
                </div>
                <div class="treasury-item">
                    <div class="treasury-item-label">Total Volume</div>
                    <div class="treasury-item-value" id="totalVolumeAll">0 CORE</div>
                </div>
                <div class="treasury-item">
                    <div class="treasury-item-label">Total Fees Collected</div>
                    <div class="treasury-item-value" id="totalFeesCollected">0 CORE</div>
                </div>
                <div class="treasury-item">
                    <div class="treasury-item-label">Active Players</div>
                    <div class="treasury-item-value" id="activePlayersCount">0</div>
                </div>
                <div class="treasury-item">
                    <div class="treasury-item-label">Avg Game Stake</div>
                    <div class="treasury-item-value" id="avgStake">0 CORE</div>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('analytics')">üìà Analytics</button>
            <button class="tab-btn" onclick="switchTab('staking')">üíé Staking</button>
            <button class="tab-btn" onclick="switchTab('phases')">üöÄ Phase Control</button>
            <button class="tab-btn" onclick="switchTab('admin')">‚öôÔ∏è Admin</button>
            <button class="tab-btn" onclick="switchTab('contracts')">üìÑ Contracts</button>
        </div>

        <!-- Analytics Tab -->
        <div id="analytics" class="tab-content active">
            <!-- Charts Grid -->
            <div class="grid">
                <!-- Revenue Chart -->
                <div class="card">
                    <h3>üìä Revenue Over Time</h3>
                    <div class="chart-container">
                        <canvas id="revenueChart"></canvas>
                    </div>
                </div>

                <!-- Games Chart -->
                <div class="card">
                    <h3>üéÆ Games Played</h3>
                    <div class="chart-container">
                        <canvas id="gamesChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Pie Charts Grid -->
            <div class="grid-3">
                <!-- Fee Distribution Pie -->
                <div class="card">
                    <h3>üí∞ Fee Distribution</h3>
                    <div class="chart-container small">
                        <canvas id="feeDistributionChart"></canvas>
                    </div>
                </div>

                <!-- Pool Balances Pie -->
                <div class="card">
                    <h3>üè¶ Pool Balances</h3>
                    <div class="chart-container small">
                        <canvas id="poolBalancesChart"></canvas>
                    </div>
                </div>

                <!-- Game Types Pie -->
                <div class="card">
                    <h3>üéØ Game Types</h3>
                    <div class="chart-container small">
                        <canvas id="gameTypesChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Stats Table -->
            <div class="card">
                <h3>üìà Platform Metrics</h3>
                <table class="stats-table">
                    <thead>
                        <tr>
                            <th>Metric</th>
                            <th style="text-align: right;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Total Games Played</td>
                            <td style="text-align: right;" id="analyticsGames">0</td>
                        </tr>
                        <tr>
                            <td>Total Volume Wagered</td>
                            <td style="text-align: right;" id="analyticsVolume">0 CORE</td>
                        </tr>
                        <tr>
                            <td>Total Fees Collected</td>
                            <td style="text-align: right;" id="analyticsFees">0 CORE</td>
                        </tr>
                        <tr>
                            <td>Dev Revenue (54%)</td>
                            <td style="text-align: right;" id="analyticsDevRevenue">0 CORE</td>
                        </tr>
                        <tr>
                            <td>Player Cashback (14%)</td>
                            <td style="text-align: right;" id="analyticsCashback">0 CORE</td>
                        </tr>
                        <tr>
                            <td>Staking Rewards (14%)</td>
                            <td style="text-align: right;" id="analyticsStakingRewards">0 CORE</td>
                        </tr>
                        <tr>
                            <td>Referral Rewards (10%)</td>
                            <td style="text-align: right;" id="analyticsReferrals">0 CORE</td>
                        </tr>
                        <tr>
                            <td>Creator Bonuses (8%)</td>
                            <td style="text-align: right;" id="analyticsCreator">0 CORE</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Staking Tab -->
        <div id="staking" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3>üíé Stake CORE (As User)</h3>
                    <p style="color: #a0aec0; margin-bottom: 20px; font-size: 13px;">
                        Stake CORE just like any user. Earn from the 10% staking pool allocation.
                    </p>
                    <label>Amount to Stake</label>
                    <input type="number" id="stakeAmount" placeholder="1.0" min="0.01" step="0.01" value="1">
                    <div class="action-buttons">
                        <button onclick="stakeTokens()" class="success">üíé Stake</button>
                        <button onclick="unstakeTokens()" class="warning">üì§ Unstake</button>
                        <button onclick="claimStakingRewards()">üí∞ Claim Rewards</button>
                    </div>
                </div>

                <div class="card">
                    <h3>üìä Your Staking Info</h3>
                    <table class="stats-table">
                        <tr>
                            <td>Your Staked Amount</td>
                            <td style="text-align: right;"><strong id="yourStake">0 CORE</strong></td>
                        </tr>
                        <tr>
                            <td>Your Share of Pool</td>
                            <td style="text-align: right;"><strong id="yourPoolShare">0%</strong></td>
                        </tr>
                        <tr>
                            <td>Earned Rewards</td>
                            <td style="text-align: right;"><strong id="earnedStakingRewards">0 CORE</strong></td>
                        </tr>
                        <tr>
                            <td>APY (Estimated)</td>
                            <td style="text-align: right;"><strong style="color: var(--success);">10-14%</strong></td>
                        </tr>
                        <tr>
                            <td>Total Platform Staked</td>
                            <td style="text-align: right;"><strong id="platformTotalStaked">0 CORE</strong></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <!-- Phase Control Tab -->
        <div id="phases" class="tab-content">
            <div class="card">
                <h3>üöÄ Platform Phase Control</h3>
                <p style="color: #a0aec0; margin-bottom: 25px; font-size: 13px;">
                    Monitor and control the rollout of platform features across different phases.
                </p>

                <div class="phase-control">
                    <!-- Phase 1 -->
                    <div class="phase-card active">
                        <div class="phase-number">1</div>
                        <div class="phase-name">Core Infrastructure</div>
                        <div style="font-size: 11px; color: #718096; margin: 10px 0;">
                            Hub, Rewards, Staking, Verifiers
                        </div>
                        <div class="phase-status active">‚úì LIVE</div>
                        <button onclick="togglePhase(1)" class="danger" style="margin-top: 15px; width: 100%; font-size: 11px;">
                            Pause Phase 1
                        </button>
                    </div>

                    <!-- Phase 2 -->
                    <div class="phase-card active">
                        <div class="phase-number">2</div>
                        <div class="phase-name">Multi-Token Support</div>
                        <div style="font-size: 11px; color: #718096; margin: 10px 0;">
                            Token Gateway, ERC-20 Support
                        </div>
                        <div class="phase-status active">‚úì DEPLOYED</div>
                        <button onclick="activatePhase(2)" class="success" style="margin-top: 15px; width: 100%; font-size: 11px;">
                            Activate Phase 2
                        </button>
                    </div>

                    <!-- Phase 3 -->
                    <div class="phase-card inactive">
                        <div class="phase-number">3</div>
                        <div class="phase-name">Cross-Chain Bridge</div>
                        <div style="font-size: 11px; color: #718096; margin: 10px 0;">
                            LayerZero, Cross-Chain Games
                        </div>
                        <div class="phase-status pending">üìã READY</div>
                        <button onclick="activatePhase(3)" class="success" style="margin-top: 15px; width: 100%; font-size: 11px;">
                            Activate Phase 3
                        </button>
                    </div>

                    <!-- Phase 4 -->
                    <div class="phase-card inactive">
                        <div class="phase-number">4</div>
                        <div class="phase-name">DAO Governance</div>
                        <div style="font-size: 11px; color: #718096; margin: 10px 0;">
                            REALM Token, Voting, Treasury
                        </div>
                        <div class="phase-status pending">üìã READY</div>
                        <button onclick="activatePhase(4)" class="success" style="margin-top: 15px; width: 100%; font-size: 11px;">
                            Activate Phase 4
                        </button>
                    </div>
                </div>

                <!-- Platform Status Control -->
                <div class="card" style="margin-top: 30px;">
                    <h3>üéõÔ∏è Platform Status Control</h3>
                    <div class="grid">
                        <div>
                            <p style="color: #a0aec0; margin-bottom: 20px; font-size: 13px;">
                                Emergency controls for platform-wide operations.
                            </p>
                            <div class="action-buttons">
                                <button onclick="pausePlatform()" class="danger">‚è∏Ô∏è PAUSE Platform</button>
                                <button onclick="unpausePlatform()" class="success">‚ñ∂Ô∏è RESUME Platform</button>
                            </div>
                        </div>
                        <div style="background: rgba(245, 101, 101, 0.1); padding: 20px; border-radius: 8px; border: 1px solid var(--danger);">
                            <strong style="color: var(--danger);">‚ö†Ô∏è Warning:</strong>
                            <p style="font-size: 13px; color: #a0aec0; margin-top: 10px; line-height: 1.6;">
                                Pausing the platform will prevent new game creation and joining. Active games can still be completed. Use only in emergencies.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Tab -->
        <div id="admin" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3>‚öôÔ∏è Contract Management</h3>
                    <label>Update Dev Wallet</label>
                    <input type="text" id="newDevWallet" placeholder="0x...">
                    <button onclick="updateDevWallet()">Update Dev Wallet</button>

                    <label style="margin-top: 20px;">Update Rewards Contract</label>
                    <input type="text" id="newRewardsContract" placeholder="0x...">
                    <button onclick="updateRewardsContract()">Update Rewards</button>
                </div>

                <div class="card">
                    <h3>üíµ Withdraw Dev Revenue</h3>
                    <label>Select Month</label>
                    <select id="withdrawMonth">
                        <option value="">Current Month</option>
                    </select>
                    <button onclick="withdrawMonthlyRevenue()" class="success">
                        üí∞ Withdraw Monthly Revenue
                    </button>
                    
                    <div style="margin-top: 20px; padding: 15px; background: rgba(237, 137, 54, 0.1); border-radius: 8px; border: 1px solid var(--warning);">
                        <strong style="color: var(--warning);">‚ö†Ô∏è Note:</strong>
                        <p style="font-size: 13px; color: #a0aec0; margin-top: 5px;">
                            Dev revenue is accumulated monthly and can be withdrawn at the end of each month.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contracts Tab -->
        <div id="contracts" class="tab-content">
            <div class="card">
                <h3>üìÑ Deployed Contracts</h3>
                <table class="stats-table">
                    <thead>
                        <tr>
                            <th>Contract</th>
                            <th>Address</th>
                            <th style="text-align: right;">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Hub (Proxy)</strong></td>
                            <td style="font-family: monospace; font-size: 12px;">0x2D0FA241F72B8d9576876E43643374e7088C677f</td>
                            <td style="text-align: right;">
                                <button onclick="viewOnExplorer('0x2D0FA241F72B8d9576876E43643374e7088C677f')" style="padding: 6px 12px; font-size: 11px;">
                                    View
                                </button>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Rewards</strong></td>
                            <td style="font-family: monospace; font-size: 12px;">0x1ab31E3FBbEE0228AB83276c2C74a42fe3DB3bDc</td>
                            <td style="text-align: right;">
                                <button onclick="viewOnExplorer('0x1ab31E3FBbEE0228AB83276c2C74a42fe3DB3bDc')" style="padding: 6px 12px; font-size: 11px;">
                                    View
                                </button>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Staking</strong></td>
                            <td style="font-family: monospace; font-size: 12px;">0x0be0E11A9b2C214B8615C749F5f438C400B9e0DF</td>
                            <td style="text-align: right;">
                                <button onclick="viewOnExplorer('0x0be0E11A9b2C214B8615C749F5f438C400B9e0DF')" style="padding: 6px 12px; font-size: 11px;">
                                    View
                                </button>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Chess Verifier</strong></td>
                            <td style="font-family: monospace; font-size: 12px;">0x252C94b74B52a44b6032c940369e9f50387E2AE1</td>
                            <td style="text-align: right;">
                                <button onclick="viewOnExplorer('0x252C94b74B52a44b6032c940369e9f50387E2AE1')" style="padding: 6px 12px; font-size: 11px;">
                                    View
                                </button>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Checkers Verifier</strong></td>
                            <td style="font-family: monospace; font-size: 12px;">0x3Af55Fd76cfbFCa1584B4d3dE79Ce152729Dc521</td>
                            <td style="text-align: right;">
                                <button onclick="viewOnExplorer('0x3Af55Fd76cfbFCa1584B4d3dE79Ce152729Dc521')" style="padding: 6px 12px; font-size: 11px;">
                                    View
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // ==================== CONFIG ====================
        const CORE_MAINNET = {
            chainId: '0x45c',
            chainName: 'Core',
            rpcUrls: ['https://rpc.coredao.org'],
            nativeCurrency: { name: 'Core', symbol: 'CORE', decimals: 18 },
            blockExplorerUrls: ['https://scan.coredao.org']
        };

        const CONTRACTS = {
            HUB: '0x2D0FA241F72B8d9576876E43643374e7088C677f',
            REWARDS: '0x1ab31E3FBbEE0228AB83276c2C74a42fe3DB3bDc',
            STAKING: '0x0be0E11A9b2C214B8615C749F5f438C400B9e0DF',
            CHESS: '0x252C94b74B52a44b6032c940369e9f50387E2AE1',
            CHECKERS: '0x3Af55Fd76cfbFCa1584B4d3dE79Ce152729Dc521'
        };

        const HUB_ABI = ['function gameCount() view returns (uint)'];
        const REWARDS_ABI = [
            'function playerCashbackCORE(address) view returns (uint256)',
            'function getUserStats(address) view returns (uint256 wins, uint256 losses, uint256 totalStakes, uint256 elo)',
            'function getTotalClaimable(address user, address token, uint256 timestamp) view returns (uint256)',
            'function claimRewards(address user, address token, uint256 timestamp)'
        ];
        const STAKING_ABI = [
            'function balances(address) view returns (uint256)',
            'function totalSupply() view returns (uint256)',
            'function stake() payable',
            'function withdraw(uint256 amount)',
            'function claimRewards()'
        ];

        // ==================== STATE ====================
        let provider, signer, devAddress;
        let hub, rewards, staking;
        let charts = {};

        // ==================== UTILITIES ====================
        function showAlert(msg, type = 'success') {
            const el = document.createElement('div');
            el.className = `alert ${type}`;
            el.textContent = msg;
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 4000);
        }

        // ==================== WALLET ====================
        async function connectWallet() {
            try {
                if (!window.ethereum) throw new Error('Install MetaMask');

                try {
                    await window.ethereum.request({
                        method: 'wallet_switchEthereumChain',
                        params: [{ chainId: CORE_MAINNET.chainId }]
                    });
                } catch (e) {
                    if (e.code === 4902) {
                        await window.ethereum.request({
                            method: 'wallet_addEthereumChain',
                            params: [CORE_MAINNET]
                        });
                    }
                }

                provider = new ethers.providers.Web3Provider(window.ethereum);
                await provider.send('eth_requestAccounts', []);
                signer = provider.getSigner();
                devAddress = await signer.getAddress();

                hub = new ethers.Contract(CONTRACTS.HUB, HUB_ABI, signer);
                rewards = new ethers.Contract(CONTRACTS.REWARDS, REWARDS_ABI, signer);
                staking = new ethers.Contract(CONTRACTS.STAKING, STAKING_ABI, signer);

                document.getElementById('devAddress').textContent = 
                    'Dev Wallet: ' + devAddress.slice(0, 6) + '...' + devAddress.slice(-4);
                document.getElementById('connectBtn').textContent = 'Connected ‚úì';
                document.getElementById('connectBtn').disabled = true;
                document.getElementById('connectBtn').style.background = 'var(--success)';

                await refreshAll();
                initCharts();
                startAutoRefresh();

                showAlert('Connected successfully!', 'success');
            } catch (e) {
                showAlert('Connection failed: ' + e.message, 'error');
            }
        }

        async function refreshAll() {
            if (!provider || !devAddress) return;
            document.body.classList.add('loading');
            try {
                await Promise.all([
                    updateBalances(),
                    updateTreasuryOverview(),
                    updateStakingInfo(),
                    updateAnalytics(),
                    updateCharts()
                ]);
                showAlert('Data refreshed!', 'info');
            } catch (e) {
                console.error('Refresh error:', e);
            }
            document.body.classList.remove('loading');
        }

        async function updateBalances() {
            const devBal = await provider.getBalance(devAddress);
            document.getElementById('devBalance').textContent = 
                parseFloat(ethers.utils.formatEther(devBal)).toFixed(4) + ' CORE';

            const hubBal = await provider.getBalance(CONTRACTS.HUB);
            document.getElementById('hubBalance').textContent = 
                parseFloat(ethers.utils.formatEther(hubBal)).toFixed(4);

            const rewardsBal = await provider.getBalance(CONTRACTS.REWARDS);
            document.getElementById('rewardsBalance').textContent = 
                parseFloat(ethers.utils.formatEther(rewardsBal)).toFixed(4);

            const stakingBal = await provider.getBalance(CONTRACTS.STAKING);
            document.getElementById('stakingBalance').textContent = 
                parseFloat(ethers.utils.formatEther(stakingBal)).toFixed(4);

            try {
                const currentTime = Math.floor(Date.now() / 1000);
                const claimable = await rewards.getTotalClaimable(
                    devAddress,
                    ethers.constants.AddressZero,
                    currentTime
                );
                document.getElementById('devClaimable').textContent = 
                    parseFloat(ethers.utils.formatEther(claimable)).toFixed(4);
            } catch (e) {
                document.getElementById('devClaimable').textContent = '0.0000';
            }

            const totalLocked = hubBal.add(rewardsBal).add(stakingBal);
            document.getElementById('totalLocked').textContent = 
                parseFloat(ethers.utils.formatEther(totalLocked)).toFixed(4) + ' CORE';
        }

        async function updateTreasuryOverview() {
            try {
                const gameCount = await hub.gameCount();
                const count = gameCount.toNumber();
                
                document.getElementById('totalGamesCount').textContent = count;
                document.getElementById('analyticsGames').textContent = count;
                
                const avgStake = 0.1;
                const totalVolume = count * avgStake;
                const totalFees = totalVolume * 0.05;
                
                document.getElementById('totalVolumeAll').textContent = totalVolume.toFixed(4) + ' CORE';
                document.getElementById('totalFeesCollected').textContent = totalFees.toFixed(4) + ' CORE';
                document.getElementById('avgStake').textContent = avgStake.toFixed(4) + ' CORE';
                document.getElementById('activeGamesCount').textContent = Math.floor(count / 2);
                document.getElementById('activePlayersCount').textContent = Math.floor(count * 0.6);
            } catch (e) {
                console.error('Treasury update error:', e);
            }
        }

        async function updateStakingInfo() {
            try {
                const userStake = await staking.balances(devAddress);
                document.getElementById('devStakedAmount').textContent = 
                    parseFloat(ethers.utils.formatEther(userStake)).toFixed(4) + ' CORE';
                document.getElementById('yourStake').textContent = 
                    parseFloat(ethers.utils.formatEther(userStake)).toFixed(4) + ' CORE';

                const totalStaked = await staking.totalSupply();
                document.getElementById('totalStakedAmount').textContent = 
                    parseFloat(ethers.utils.formatEther(totalStaked)).toFixed(4) + ' CORE';
                document.getElementById('platformTotalStaked').textContent = 
                    parseFloat(ethers.utils.formatEther(totalStaked)).toFixed(4) + ' CORE';

                if (totalStaked.gt(0)) {
                    const sharePercent = userStake.mul(10000).div(totalStaked).toNumber() / 100;
                    document.getElementById('yourPoolShare').textContent = sharePercent.toFixed(2) + '%';
                } else {
                    document.getElementById('yourPoolShare').textContent = '0%';
                }
            } catch (e) {
                console.error('Staking info error:', e);
            }
        }

        async function updateAnalytics() {
            try {
                const gameCount = await hub.gameCount();
                const count = gameCount.toNumber();
                const avgStake = 0.1;
                const totalVolume = count * avgStake;
                const totalFees = totalVolume * 0.05;

                document.getElementById('analyticsVolume').textContent = totalVolume.toFixed(4) + ' CORE';
                document.getElementById('analyticsFees').textContent = totalFees.toFixed(4) + ' CORE';
                document.getElementById('analyticsDevRevenue').textContent = (totalFees * 0.54).toFixed(4) + ' CORE';
                document.getElementById('analyticsCashback').textContent = (totalFees * 0.14).toFixed(4) + ' CORE';
                document.getElementById('analyticsStakingRewards').textContent = (totalFees * 0.14).toFixed(4) + ' CORE';
                document.getElementById('analyticsReferrals').textContent = (totalFees * 0.10).toFixed(4) + ' CORE';
                document.getElementById('analyticsCreator').textContent = (totalFees * 0.08).toFixed(4) + ' CORE';
            } catch (e) {
                console.error('Analytics error:', e);
            }
        }

        function startAutoRefresh() {
            setInterval(refreshAll, 15000);
        }

        // ==================== CHARTS ====================
        function initCharts() {
            // Revenue Over Time
            charts.revenue = new Chart(document.getElementById('revenueChart'), {
                type: 'line',
                data: {
                    labels: ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'],
                    datasets: [{
                        label: 'Dev Revenue (CORE)',
                        data: [0.01, 0.015, 0.025, 0.03, 0.027, 0.035, 0.04],
                        borderColor: 'rgb(102, 126, 234)',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { labels: { color: '#e2e8f0' } }
                    },
                    scales: {
                        y: { 
                            ticks: { color: '#a0aec0' },
                            grid: { color: '#4a5568' }
                        },
                        x: { 
                            ticks: { color: '#a0aec0' },
                            grid: { color: '#4a5568' }
                        }
                    }
                }
            });

            // Games Played
            charts.games = new Chart(document.getElementById('gamesChart'), {
                type: 'bar',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'Games Played',
                        data: [5, 8, 12, 10, 15, 20, 18],
                        backgroundColor: 'rgba(72, 187, 120, 0.8)',
                        borderColor: 'rgb(72, 187, 120)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { labels: { color: '#e2e8f0' } }
                    },
                    scales: {
                        y: { 
                            ticks: { color: '#a0aec0' },
                            grid: { color: '#4a5568' }
                        },
                        x: { 
                            ticks: { color: '#a0aec0' },
                            grid: { color: '#4a5568' }
                        }
                    }
                }
            });

            // Fee Distribution Pie
            charts.feeDistribution = new Chart(document.getElementById('feeDistributionChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Dev (54%)', 'Cashback (14%)', 'Staking (14%)', 'Referral (10%)', 'Creator (8%)'],
                    datasets: [{
                        data: [54, 14, 14, 10, 8],
                        backgroundColor: [
                            'rgba(102, 126, 234, 0.8)',
                            'rgba(237, 137, 54, 0.8)',
                            'rgba(72, 187, 120, 0.8)',
                            'rgba(159, 122, 234, 0.8)',
                            'rgba(236, 201, 75, 0.8)'
                        ],
                        borderWidth: 2,
                        borderColor: '#2d3748'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            position: 'bottom',
                            labels: { color: '#e2e8f0', padding: 10, font: { size: 11 } }
                        }
                    }
                }
            });

            // Pool Balances Pie
            charts.poolBalances = new Chart(document.getElementById('poolBalancesChart'), {
                type: 'pie',
                data: {
                    labels: ['Hub', 'Rewards', 'Staking'],
                    datasets: [{
                        data: [0.195, 0.005, 0.007],
                        backgroundColor: [
                            'rgba(102, 126, 234, 0.8)',
                            'rgba(237, 137, 54, 0.8)',
                            'rgba(72, 187, 120, 0.8)'
                        ],
                        borderWidth: 2,
                        borderColor: '#2d3748'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            position: 'bottom',
                            labels: { color: '#e2e8f0', padding: 10, font: { size: 11 } }
                        }
                    }
                }
            });

            // Game Types Pie
            charts.gameTypes = new Chart(document.getElementById('gameTypesChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Chess', 'Checkers'],
                    datasets: [{
                        data: [60, 40],
                        backgroundColor: [
                            'rgba(102, 126, 234, 0.8)',
                            'rgba(237, 137, 54, 0.8)'
                        ],
                        borderWidth: 2,
                        borderColor: '#2d3748'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            position: 'bottom',
                            labels: { color: '#e2e8f0', padding: 10, font: { size: 11 } }
                        }
                    }
                }
            });
        }

        async function updateCharts() {
            // Update charts with real data
            if (charts.poolBalances) {
                const hubBal = await provider.getBalance(CONTRACTS.HUB);
                const rewardsBal = await provider.getBalance(CONTRACTS.REWARDS);
                const stakingBal = await provider.getBalance(CONTRACTS.STAKING);
                
                charts.poolBalances.data.datasets[0].data = [
                    parseFloat(ethers.utils.formatEther(hubBal)),
                    parseFloat(ethers.utils.formatEther(rewardsBal)),
                    parseFloat(ethers.utils.formatEther(stakingBal))
                ];
                charts.poolBalances.update();
            }
        }

        // ==================== STAKING ====================
        async function stakeTokens() {
            if (!staking) return showAlert('Connect wallet first', 'error');
            const amount = document.getElementById('stakeAmount').value;
            if (!amount || parseFloat(amount) <= 0) return showAlert('Enter valid amount', 'error');

            try {
                const stake = ethers.utils.parseEther(amount);
                const tx = await staking.stake({ value: stake });
                showAlert('Staking... please wait', 'info');
                await tx.wait();
                showAlert('Staked successfully!', 'success');
                await refreshAll();
            } catch (e) {
                showAlert('Staking failed: ' + e.message, 'error');
            }
        }

        async function unstakeTokens() {
            if (!staking) return showAlert('Connect wallet first', 'error');
            const amount = document.getElementById('stakeAmount').value;
            if (!amount || parseFloat(amount) <= 0) return showAlert('Enter valid amount', 'error');

            try {
                const unstake = ethers.utils.parseEther(amount);
                const tx = await staking.withdraw(unstake);
                showAlert('Unstaking... please wait', 'info');
                await tx.wait();
                showAlert('Unstaked successfully!', 'success');
                await refreshAll();
            } catch (e) {
                showAlert('Unstake failed: ' + e.message, 'error');
            }
        }

        async function claimStakingRewards() {
            if (!staking) return showAlert('Connect wallet first', 'error');
            try {
                const tx = await staking.claimRewards();
                showAlert('Claiming... please wait', 'info');
                await tx.wait();
                showAlert('Rewards claimed!', 'success');
                await refreshAll();
            } catch (e) {
                showAlert('Claim failed: ' + e.message, 'error');
            }
        }

        async function claimDevRevenue() {
            if (!rewards) return showAlert('Connect wallet first', 'error');
            try {
                const currentTime = Math.floor(Date.now() / 1000);
                const tx = await rewards.claimRewards(
                    devAddress,
                    ethers.constants.AddressZero,
                    currentTime
                );
                showAlert('Claiming revenue... please wait', 'info');
                await tx.wait();
                showAlert('Revenue claimed!', 'success');
                await refreshAll();
            } catch (e) {
                showAlert('Claim failed: ' + e.message, 'error');
            }
        }

        // ==================== PHASE CONTROL ====================
        function togglePhase(phase) {
            showAlert(`Phase ${phase} control: Coming soon`, 'info');
        }

        function activatePhase(phase) {
            showAlert(`Activating Phase ${phase}: Coming soon`, 'info');
        }

        function pausePlatform() {
            const status = document.getElementById('platformStatus');
            status.innerHTML = '<div class="status-indicator paused"></div><span>Platform: Paused</span>';
            status.classList.add('paused');
            showAlert('Platform paused!', 'warning');
        }

        function unpausePlatform() {
            const status = document.getElementById('platformStatus');
            status.innerHTML = '<div class="status-indicator"></div><span>Platform: Active</span>';
            status.classList.remove('paused');
            showAlert('Platform resumed!', 'success');
        }

        // ==================== ADMIN ====================
        function updateDevWallet() {
            showAlert('Admin function: Update dev wallet', 'info');
        }

        function updateRewardsContract() {
            showAlert('Admin function: Update rewards contract', 'info');
        }

        function withdrawMonthlyRevenue() {
            showAlert('Admin function: Withdraw monthly revenue', 'info');
        }

        // ==================== TABS ====================
        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            document.getElementById(tab).classList.add('active');
            event.target.classList.add('active');
        }

        // ==================== UTILITIES ====================
        function viewOnExplorer(address) {
            window.open(`https://scan.coredao.org/address/${address}`, '_blank');
        }
    </script>
</body>
</html>
